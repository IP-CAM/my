<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="renderer" content="webkit" />
    <title>{$meta_title|default=''} | {:lang('cmfname')}</title>
    <link href="__ROOT__/favicon.ico" type="image/x-icon" rel="shortcut icon">
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/admin/css/style.css" />
    <link rel="stylesheet" type="text/css" href="__CSS__/jquery-ui.min.css" />
    <link rel="stylesheet" type="text/css" href="__CSS__/jquery-ui-timepicker-addon.min.css" />
    <!-- jquery files -->
    <!--[if lt IE 9]>
    <script type="text/javascript" src="__JS__/jquery-1.9.1.min.js"></script>
    <![endif]-->
    <!--[if gte IE 9]><!-->
    <script type="text/javascript" src="__JS__/jquery-2.1.4.min.js"></script>
    <!--<![endif]-->
    
    <script type="text/javascript" src="__JS__/jquery-ui.min.js"></script>
    <script type="text/javascript" src="__JS__/jquery-ui-timepicker-addon.min.js"></script>
    <script type="text/javascript" src="__JS__/jquery-ui-i18n.min.js"></script>
    <!-- tooltip files -->
    <script type="text/javascript" src="__JS__/jquery.tipTip.min.js"></script>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/admin/css/tipTip.css" />
    <!-- don't move it -->
    <script type="text/javascript" src="__PUBLIC__/admin/js/main.js"></script>
    <script type="text/javascript" src="__ROOT__/static/layer-v3.0.3/layer.js"></script>
    <script type="text/javascript" src="__PUBLIC__/{$js_path}/common.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <!--search select input-->
    <script type="text/javascript" src="__ROOT__/static/chosen/chosen.jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="__ROOT__/static/chosen/chosen.min.css" />
    <style>
        p { margin: 0;  }
        
        .imgbox {
            border-radius: 3px;
            border: 1px #c7c5ca solid;
            height: 285px;
            padding: 5px 0px;
            position: relative;
        }
        
        .imgbox ul {
            list-style: none;
            margin: 0 !important;
            padding: 0 !important;
            overflow-x: hidden;
            overflow-y: auto;
            position: relative;
            height: 285px;
        }
        
        .imgbox ul::-webkit-scrollbar {
            width: 12px;
            background-color: #F5F5F5;
        }
        
        /*定义滚动条轨道 内阴影+圆角*/
        .imgbox ul::-webkit-scrollbar-track {
            -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);
            background-color: #F5F5F5;
        }
        
        /*定义滑块 内阴影+圆角*/
        .imgbox ul::-webkit-scrollbar-thumb {
            border-radius: 10px;
            -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, .3);
            background-color: #555;
        }
        
        .imgbox ul li {
            border: 1px #c7c5ca solid;
            width: 113px;
            height: 113px;
            text-align: center;
            margin: 8px 0 0 14px;
            position: relative;
            display: block;
            float: left;
            overflow: hidden;
            font-size: 12px;
        }
        
        .webuploader-element-invisible {
            position: absolute;
            clip: rect(1px 1px 1px 1px);
            clip: rect(1px, 1px, 1px, 1px);
        }
        
        .imgtop {
            height: 45px;
            line-height: 45px;
            padding: 0px 10px;
        }
        
        .netimg_prview {
            display: block;
            position: absolute;
            text-align: center;
            clear: both;
            width: 220px;
            height: 200px;
            z-index: 9999;
            margin-top: 10px;
            background-color: rgb(238, 238, 238);
            overflow: hidden;
            right: 4px;
            bottom: 4px;
            margin: 0 10px 10px 0;
            border: 1px #f3f3f5 solid;
        }
        
        #wrapper {
            margin: 0 auto;
            width: auto;
        }
        
        #uploader .queueList {
            height: 100%;
        }
        
        .element-invisible {
            position: absolute !important;
            clip: rect(1px 1px 1px 1px); /* IE6, IE7 */
            clip: rect(1px, 1px, 1px, 1px);
        }
        
        #uploader .placeholder {
            border: 2px dashed #e6e6e6;
            min-height: 180px;
            margin: 0 8px;
            padding-top: 98px;
            text-align: center;
            background: url(__PUBLIC__/admin/images/image.png) center 24px no-repeat;
            color: #cccccc;
            font-size: 18px;
            position: relative;
        }
        
        #uploader .placeholder .webuploader-pick {
            font-size: 18px;
            background: #00b7ee;
            border-radius: 3px;
            line-height: 44px;
            padding: 0 30px;
            color: #fff;
            display: inline-block;
            margin: 15px auto;
            cursor: pointer;
            box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
        }
        
        #uploader .placeholder .webuploader-pick-hover {
            background: #00a2d4;
        }
        
        #uploader .placeholder .flashTip {
            color: #666666;
            font-size: 12px;
            position: absolute;
            width: 100%;
            text-align: center;
            bottom: 20px;
        }
        
        #uploader .placeholder .flashTip a {
            color: #0785d1;
            text-decoration: none;
        }
        
        #uploader .placeholder .flashTip a:hover {
            text-decoration: underline;
        }
        
        #uploader .placeholder.webuploader-dnd-over {
            border-color: #999999;
        }
        
        #uploader .placeholder.webuploader-dnd-over.webuploader-dnd-denied {
            border-color: red;
        }
        
        #uploader .filelist {
            list-style: none !important;
            margin: 0 0 0 10px;
            padding: 0;
        }
        
        #uploader .filelist:after {
            content: '';
            display: block;
            width: 0;
            height: 0;
            overflow: hidden;
            clear: both;
        }
        
        #uploader .filelist li, #filePickerBlock {
            border: 1px #c7c5ca solid;
            width: 113px;
            height: 113px;
            background: url(__PUBLIC__/admin/images/bg.png) no-repeat;
            text-align: center;
            margin: 8px 0 0 14px;
            position: relative;
            display: inline;
            float: left;
            overflow: hidden;
            font-size: 12px;
        }
        
        #uploader .filelist li, #filePickerBlock {
            background: url(__PUBLIC__/admin/images/image.png) no-repeat center 12px;
        }
        
        #filePickerBlock .webuploader-pick {
            width: 100%;
            height: 100%;
            display: block;
        }
        
        #uploader .filelist li p.log {
            position: relative;
            top: -45px;
        }
        
        #uploader .filelist li p.inp{
            position: absolute;
            top: 0;
            left: 0;
            z-index: 9;
            display: none;
        }
        
        #uploader .filelist li p.inp input{
            width: 20px;
            height: 20px;
        }
        
        #uploader .filelist li p.inp input[type="checkbox"].ui-input:checked,
        #uploader .filelist li p.inp input[type="radio"].ui-input:checked
        {
            background: url(__PUBLIC__/admin/images/selected.png) 0 0 no-repeat;
        }
        
        #uploader .filelist li p.inp input[type="checkbox"].ui-input,
        #uploader .filelist li p.inp input[type="radio"].ui-input
        {
            width: 24px;
            height: 24px;
            background: url(__PUBLIC__/admin/images/noselected.png) 0 0 no-repeat;
            -webkit-appearance: none;
        }
        
        #uploader .filelist li p.title {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            top: 5px;
            text-indent: 5px;
            text-align: left;
        }
        
        #uploader .filelist li p.progress {
            position: absolute;
            width: 100%;
            bottom: 0;
            left: 0;
            height: 8px;
            overflow: hidden;
            z-index: 50;
        }
        
        #uploader .filelist li p.progress span {
            display: none;
            overflow: hidden;
            width: 0;
            height: 100%;
            background: #1483d8 url(__PUBLIC__/admin/images/progress.png) repeat-x;
            -webit-transition: width 200ms linear;
            -moz-transition: width 200ms linear;
            -o-transition: width 200ms linear;
            -ms-transition: width 200ms linear;
            transition: width 200ms linear;
            
            -webkit-animation: progressmove 2s linear infinite;
            -moz-animation: progressmove 2s linear infinite;
            -o-animation: progressmove 2s linear infinite;
            -ms-animation: progressmove 2s linear infinite;
            animation: progressmove 2s linear infinite;
            
            -webkit-transform: translateZ(0);
        }
        
        @-webkit-keyframes progressmove {
            0% {
                background-position: 0 0;
            }
            100% {
                background-position: 17px 0;
            }
        }
        
        @-moz-keyframes progressmove {
            0% {
                background-position: 0 0;
            }
            100% {
                background-position: 17px 0;
            }
        }
        
        @keyframes progressmove {
            0% {
                background-position: 0 0;
            }
            100% {
                background-position: 17px 0;
            }
        }
        
        #uploader .filelist li p.imgWrap {
            position: relative;
            z-index: 2;
            line-height: 113px;
            vertical-align: middle;
            overflow: hidden;
            width: 113px;
            height: 113px;
            
            -webkit-transform-origin: 50% 50%;
            -moz-transform-origin: 50% 50%;
            -o-transform-origin: 50% 50%;
            -ms-transform-origin: 50% 50%;
            transform-origin: 50% 50%;
            
            -webit-transition: 200ms ease-out;
            -moz-transition: 200ms ease-out;
            -o-transition: 200ms ease-out;
            -ms-transition: 200ms ease-out;
            transition: 200ms ease-out;
        }
        
        #uploader .filelist li img {
            width: 100%;
        }
        
        #uploader .filelist li p.error {
            background: #f43838;
            color: #fff;
            position: absolute;
            bottom: 0;
            left: 0;
            height: 28px;
            line-height: 28px;
            width: 100%;
            z-index: 100;
            padding: 0;
        }
        
        #uploader .filelist li .success {
            display: block;
            position: absolute;
            left: 0;
            bottom: 0;
            height: 40px;
            width: 100%;
            z-index: 200;
            background: url(__PUBLIC__/admin/images/success.png) no-repeat right bottom;
        }
        
        .filelist li .icon {
            cursor: pointer;
            width: 113px;
            height: 113px;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 2;
            border: 0;
            background-repeat: no-repeat;
        }
        
        .filelist li .icon:hover {
            width: 107px;
            height: 107px;
            border: 3px solid #1094fa;
        }
        
        .filelist li.selected{
            background-image: url(__PUBLIC__/admin/images/success.png);
            background-position: 75px 75px;
        }
        
        .filelist li.selected .icon {
            background-image: url(__PUBLIC__/admin/images/success.png);
            background-position: 75px 75px;
        }
        
        .filelist li.selected .icon:hover {
            width: 107px;
            height: 107px;
            border: 3px solid #1094fa;
            background-position: 72px 72px;
        }
        
        #uploader .filelist div.file-panel {
            position: absolute;
            height: 0;
            filter: progid:DXImageTransform.Microsoft.gradient(GradientType=0, startColorstr='#80000000', endColorstr='#80000000') \0;
            background: rgba(0, 0, 0, 0.5);
            width: 100%;
            top: 0;
            left: 0;
            overflow: hidden;
            z-index: 300;
        }
        
        #uploader .filelist div.file-panel span {
            width: 24px;
            height: 24px;
            display: inline;
            float: right;
            text-indent: -9999px;
            overflow: hidden;
            background: url(__STATIC__/images/img-icons.png) no-repeat;
            margin: 5px 1px 1px;
            cursor: pointer;
        }
        
        #uploader .filelist div.file-panel span.rotateLeft {
            background-position: 0 -24px;
        }
        
        #uploader .filelist div.file-panel span.rotateLeft:hover {
            background-position: 0 0;
        }
        
        #uploader .filelist div.file-panel span.rotateRight {
            background-position: -24px -24px;
        }
        
        #uploader .filelist div.file-panel span.rotateRight:hover {
            background-position: -24px 0;
        }
        
        #uploader .filelist div.file-panel span.cancel {
            background-position: -48px -24px;
        }
        
        #uploader .filelist div.file-panel span.cancel:hover {
            background-position: -48px 0;
        }
        
        .statusBar {
            border-top: 1px solid #dadada;
            vertical-align: middle;
            position: relative;
        }
        
        .statusBar .progress {
            border: 1px solid #1483d8;
            width: 198px;
            top: 15px;
            background: #fff;
            height: 18px;
            position: absolute;
            display: inline-block;
            text-align: center;
            line-height: 20px;
            color: #6dbfff;
            margin-right: 10px;
        }
        
        .statusBar .progress span.percentage {
            width: 0;
            height: 100%;
            left: 0;
            top: 0;
            background: #1483d8;
            position: absolute;
        }
        
        .statusBar .progress span.text {
            position: relative;
            z-index: 10;
        }
        
        .statusBar .info {
            display: inline-block;
            font-size: 14px;
            color: #666666;
        }
        
        .statusBar .btns {
            position: absolute;
            top: 3px;
            right: 14px;
            line-height: 40px;
        }
        
        .statusBar .btns .webuploader-pick,
        .statusBar .btns .uploadBtn,
        .statusBar .btns .uploadBtn.state-uploading,
        .statusBar .btns .uploadBtn.state-paused {
            /*background: #ffffff;
            border: 1px solid #cfcfcf;
            color: #565656;
            padding: 0 18px;
            margin-left: 10px;*/
            display: inline-block;
            border-radius: 3px;
            cursor: pointer;
            font-size: 14px;
            
        }
        
        .statusBar .btns .webuploader-pick-hover,
        .statusBar .btns .uploadBtn:hover,
        .statusBar .btns .uploadBtn.state-uploading:hover,
        .statusBar .btns .uploadBtn.state-paused:hover { /*background: #f0f0f0;*/
        }
        
        .statusBar .btns .uploadBtn {
            background: #00b7ee;
            color: #fff;
            border-color: transparent;
        }
        
        .statusBar .btns .uploadBtn:hover {
            background: #00a2d4;
        }
        
        .statusBar .btns .uploadBtn.disabled {
            pointer-events: none;
            opacity: 0.6;
        }
    </style>
</head>
<body>

<!-- CONTENT -->
<div id="content" style="margin:0px 10px 5px 8px;">
    <div class="bloc">
        <div class="title">
            <div class="tabs static">
                <a href="#uploader" class="up-icon norember">{:lang('Localup')}</a>
                <a href="#Netimages" class="link-icon norember">{:lang('Netimages')}</a>
                <a href="#Onlinemag" class="file-icon norember">{:lang('Onlinemag')}</a>
                <a href="#Imagesearch" class="search-icon norember">{:lang('Imagesearch')}</a>
            </div>
        </div>
        <div class="content" style="height:348px; ">
            <div id="uploader" style="display:block;">
                <div class="statusBar imgtop">
                    <div class="progress fl">
                        <span class="text">0%</span>
                        <span class="percentage"></span>
                    </div>
                    <div class="info fl"></div>
                    <div class="btns fr">
                        <button class="button element-invisible" id="selected">
                            {:lang('Add selected file')}
                        </button>
                        
                        <button class="button white element-invisible" id="filePicker2">
                            {:lang('Continue to add')}
                        </button>
                        
                        <button class="uploadBtn button element-invisible" style="margin-right: 10px;">
                            {:lang('Beginupload')}
                        </button>
                    </div>
                </div>
                
                <div class="imgbox" id="wrapper">
                    <div class="queueList">
                        <div id="dndArea" class="placeholder">
                            <div id="filePicker"></div>
                            <p>{:lang('Dragup to 300 pic at most')}</p>
                        </div>
                        
                        <ul class="filelist">
                            <span id="filePickerBlock" class="filePickerBlock"></span>
                        </ul>
                    
                    </div>
                </div>
            
            </div>
            
            <div id="Netimages" style="display:block; position: relative;">
                <form id="myform" style="margin-top:5px;" class="">
                    <fieldset style="height: 265px;">
                        <legend>{:lang('Netimages')}</legend>
                        
                        <div class="row">
                            <label for="netimgurl" class="w100">{:lang('Remote img url')}</label>
                            <input id="netimgurl" type="text" value="" name="netimgurl" style="width:500px;"
                                   placeholder="http://">
                        </div>
                        
                        <div class="row">
                            <label for="width" class="w100">{:lang('Size')}</label>
                            <input id="width" type="number" value="" name="width" style="width:50px;" min="0"/>px X
                            &nbsp;&nbsp;<input id="height" type="number" value="" name="height" style="width:50px;"
                                               min="0"/>px
                        </div>
                        
                        <div class="row">
                            <label for="border" class="w100">{:lang('Border')}</label>
                            <input id="border" type="text" value="" style="width:160px;" name="border"/> px
                        </div>
                        
                        <div class="row">
                            <label for="margin" class="w100">{:lang('Margin')}</label>
                            <input id="margin" type="text" style="width:160px;" value="" name="margin"/> px
                        </div>
                        
                        <div class="row">
                            <label for="keywords" class="w100">{:lang('Keywords')}</label>
                            <input id="keywords" type="text" value="" name="keywords"
                                   placeholder="{:lang('Image')}{:lang('Keywords')}"/>
                        </div>
                        
                        <div class="row">
                            <label for="remark" class="w100">{:lang('Remark')}</label>
                            <input id="remark" type="text" value="" name="remark"/>
                        </div>
                        
                        <div class="netimg_prview"></div>
                    </fieldset>
                </form>
                
                <div class="row imgtop"
                     style="border-top: 1px #ccc solid; margin-top: 10px; height: 40px; line-height: 40px;">
                    <div class="fl">&nbsp;</div>
                    <div class="btns fr">
                        <input type="button" class="button" style="padding: 5px 20px;" value="{:lang('Confirm')}"
                               name="Netimages" />
                        <input type="button" class="button white" style="padding: 5px 20px;" name="reset"
                               value="{:lang('Cancel')}" />
                    </div>
                </div>
            </div>
            
            <div id="Onlinemag" style="display:block;">
                <div class="imgbox">
                    <ul class="filelist">
                        <li>
                            <img width="179"
                                 src="http://ueditor.baidu.com/server/ueditor/upload/image/1.jpg?noCache=j32gnmqy"
                                 _src="http://ueditor.baidu.com/server/ueditor/upload/image/1.jpg?noCache=j32gnmqy"
                                 height="113" style="margin-left: -33px;">
                            <span class="icon"></span>
                        </li>
                        
                        <li>
                            <img width="179"
                                 src="http://ueditor.baidu.com/server/ueditor/upload/image/4.jpg?noCache=j32gnmqy"
                                 _src="http://ueditor.baidu.com/server/ueditor/upload/image/4.jpg?noCache=j32gnmqz"
                                 height="113" style="margin-left: -33px;">
                            <span class="icon"></span>
                        </li>
                        
                        <li>
                            <img width="179"
                                 src="http://ueditor.baidu.com/server/ueditor/upload/image/14.jpg?noCache=j32gnmqz"
                                 _src="http://ueditor.baidu.com/server/ueditor/upload/image/14.jpg?noCache=j32gnmqz"
                                 height="113" style="margin-left: -33px;">
                            <span class="icon"></span>
                        </li>
                        
                        <li>
                            <img width="179"
                                 src="http://ueditor.baidu.com/server/ueditor/upload/image/2.jpg?noCache=j32gnmqz"
                                 _src="http://ueditor.baidu.com/server/ueditor/upload/image/2.jpg?noCache=j32gnmqz"
                                 height="113" style="margin-left: -33px;">
                            <span class="icon"></span>
                        </li>
                        
                        <li>
                            <img width="179"
                                 src="http://ueditor.baidu.com/server/ueditor/upload/image/5.jpg?noCache=j32gnmqz"
                                 _src="http://ueditor.baidu.com/server/ueditor/upload/image/5.jpg?noCache=j32gnmqz"
                                 height="113" style="margin-left: -33px;">
                            <span class="icon"></span>
                        </li>
                        
                        <li>
                            <img width="179"
                                 src="http://ueditor.baidu.com/server/ueditor/upload/image/6.jpg?noCache=j32gnmqz"
                                 _src="http://ueditor.baidu.com/server/ueditor/upload/image/6.jpg?noCache=j32gnmqz"
                                 height="113" style="margin-left: -33px;">
                            <span class="icon"></span>
                        </li>
                        
                        <li>
                            <img width="179"
                                 src="http://ueditor.baidu.com/server/ueditor/upload/image/13.jpg?noCache=j32gnmqz"
                                 _src="http://ueditor.baidu.com/server/ueditor/upload/image/13.jpg?noCache=j32gnmqz"
                                 height="113" style="margin-left: -33px;">
                            <span class="icon"></span>
                        </li>
                        
                        <li>
                            <img width="179"
                                 src="http://ueditor.baidu.com/server/ueditor/upload/image/12.jpg?noCache=j32gnmqz"
                                 _src="http://ueditor.baidu.com/server/ueditor/upload/image/12.jpg?noCache=j32gnmqz"
                                 height="113" style="margin-left: -33px;">
                            <span class="icon"></span>
                        </li>
                        
                        <li>
                            <img width="179"
                                 src="http://ueditor.baidu.com/server/ueditor/upload/image/11.jpg?noCache=j32gnmqz"
                                 _src="http://ueditor.baidu.com/server/ueditor/upload/image/11.jpg?noCache=j32gnmqz"
                                 height="113" style="margin-left: -33px;">
                            <span class="icon"></span>
                        </li>
                        
                        <li>
                            <img width="179"
                                 src="http://ueditor.baidu.com/server/ueditor/upload/image/10.jpg?noCache=j32gnmqz"
                                 _src="http://ueditor.baidu.com/server/ueditor/upload/image/10.jpg?noCache=j32gnmqz"
                                 height="113" style="margin-left: -33px;">
                            <span class="icon"></span>
                        </li>
                        
                        <li>
                            <img width="179"
                                 src="http://ueditor.baidu.com/server/ueditor/upload/image/9.jpg?noCache=j32gnmqz"
                                 _src="http://ueditor.baidu.com/server/ueditor/upload/image/9.jpg?noCache=j32gnmqz"
                                 height="113" style="margin-left: -33px;">
                            <span class="icon"></span>
                        </li>
                        
                        <li>
                            <img width="179"
                                 src="http://ueditor.baidu.com/server/ueditor/upload/image/8.jpg?noCache=j32gnmqz"
                                 _src="http://ueditor.baidu.com/server/ueditor/upload/image/8.jpg?noCache=j32gnmqz"
                                 height="113" style="margin-left: -33px;">
                            <span class="icon"></span>
                        </li>
                        
                        <li>
                            <img width="179"
                                 src="http://ueditor.baidu.com/server/ueditor/upload/image/7.jpg?noCache=j32gnmqz"
                                 _src="http://ueditor.baidu.com/server/ueditor/upload/image/7.jpg?noCache=j32gnmqz"
                                 height="113" style="margin-left: -33px;">
                            <span class="icon"></span>
                        </li>
                    </ul>
                </div>
                <div class="row imgtop statusBar"
                     style="border-top: 1px #ccc solid; margin-top: 10px; height: 40px; line-height: 40px;">
                    <div class="fl">&nbsp;</div>
                    <div class="btns fr">
                        <input type="button" class="button" style="padding: 5px 20px;" value="{:lang('Confirm')}"
                               name="Onlinemag"/>
                        <input type="button" class="button white" style="padding: 5px 20px;" name="reset"
                               value="{:lang('Cancel')}"/>
                    </div>
                </div>
            </div>
            
            <div id="Imagesearch" style="display:block;">
                <form style="margin-top: 0px;">
                    <div class="row imgtop statusBar">
                        <!--<label for="searchkey" class="w100">{:lang('Search key tip')}： </label>-->
                        <input type="text" class="input" name="searchkey" id="searchkey" placeholder="{:lang('Images key')}" style="width: 330px;" />
                        <div class="btns">
                            <input type="button" class="button" style="padding: 5px 20px;" value="{:lang('Imagesearch')}"
                                   name="search"/>
                            <input type="button" class="button" style="padding: 5px 20px;" value="{:lang('Confirm')}"
                                   name="Imagesearch"/>
                            <input type="button" class="button white" style="padding: 5px 38px;" name="reset"
                                   value="{:lang('Cancel')}"/>
                        </div>
                    </div>
                </form>
                
                <div class="imgbox">
                    <ul class="list">
                        <li>
                            <img width="179"
                                 src="http://ueditor.baidu.com/server/ueditor/upload/image/13.jpg?noCache=j32gnmqz"
                                 _src="http://ueditor.baidu.com/server/ueditor/upload/image/13.jpg?noCache=j32gnmqz"
                                 height="113" style="margin-left: -33px;">
                            <span class="icon"></span>
                        </li>
                        
                        <li>
                            <img width="179"
                                 src="http://ueditor.baidu.com/server/ueditor/upload/image/12.jpg?noCache=j32gnmqz"
                                 _src="http://ueditor.baidu.com/server/ueditor/upload/image/12.jpg?noCache=j32gnmqz"
                                 height="113" style="margin-left: -33px;">
                            <span class="icon"></span>
                        </li>
                        
                        <li>
                            <img width="179"
                                 src="http://ueditor.baidu.com/server/ueditor/upload/image/11.jpg?noCache=j32gnmqz"
                                 _src="http://ueditor.baidu.com/server/ueditor/upload/image/11.jpg?noCache=j32gnmqz"
                                 height="113" style="margin-left: -33px;">
                            <span class="icon"></span>
                        </li>
                        
                        <li>
                            <img width="179"
                                 src="http://ueditor.baidu.com/server/ueditor/upload/image/10.jpg?noCache=j32gnmqz"
                                 _src="http://ueditor.baidu.com/server/ueditor/upload/image/10.jpg?noCache=j32gnmqz"
                                 height="113" style="margin-left: -33px;">
                            <span class="icon"></span>
                        </li>
                    </ul>
                </div>
            </div>
        
        </div>
    </div>
</div>

<script type="text/javascript" src="__ROOT__/static/webuploader/webuploader.nolog.min.js"></script>
<script>
    $(function () {
        var topindex = parent.layer.getFrameIndex(window.name); //获取当前窗体索引
        
        $('input[name="reset"],input[name="reset2"],input[name="reset3"]').click(function () {
            parent.layer.close(topindex);
        });

        //获取选中的图片值
        var inputer = '{$get.input|default=""}';
        var thumb = '{$get.thumb|default=""}';
        var path    = "__UPLOADS__";
        var objExp  = new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/);
        //对全局图片进行处理；
        {notempty name="get.wname"}
        var pin = parent.layer.getFrameIndex("{$get.wname}");  //弹层索引
        var pbd = parent.layer.getChildFrame('body', pin);     //跨layer获取DOM元素
        {/notempty}
        
        {notempty name="get.wname"}
        var allimg = pbd.find('#' + inputer);  //存放选中的图片
        {else /}
        var allimg = parent.$('#' + inputer);
        {/notempty}
        
        //未定义页面接收元素时
        if(inputer != 'all' && inputer == '')
        {
            layer.msg(
                '{:lang("Not find input img iden")}',
                {
                    icon:5,
                    time: 7000,
                    shade: 0.3
                },
                function(){
                    parent.layer.close(topindex);
                }
            );
        }

        // 上传图片-选择按钮
        $('#selected').on('click', function () {
            {notempty name="get.to_des"}
            // 返回图片到编辑器
            var to_des_img = '';
            var to_des_path = pbd.find('#' + inputer).attr('data-upload');
            $('.filelist').find('li.state-complete.selected').each(function(){
                var img = '<img src="'+to_des_path+'/' + $(this).find('.inp input').val() + '" />';
                to_des_img += img;
            });
            // console.log(to_des_img);
            // var _insert_html = '223';
            if(to_des_img === ''){
                layer.msg('{:lang("Noselect images")}', {icon: 2});
                return false;
            }
            var des = pbd.find('#' + inputer).parent().find("iframe.ke-edit-iframe").contents().find("body.ke-content");
            des.append(to_des_img);
            // pbd.find('#' + inputer).append();
            des.focus();
            parent.layer.close(topindex);

            {else /}
            if(allimg.val() == '')
            {
                layer.msg('{:lang("Noselect images")}', {icon: 2});
                return false;
            }
            parent.layer.close(topindex);
            {/notempty}

        });

        //网络图片来源
        $('input[name="netimgurl"]').on('change', function () {
            var url = $(this).val();
            url && $('.netimg_prview').append('<img src=' + url + ' width ="220" height="" style="0px solid #000" /> ');
        })

        //网络图片高度
        $('input[name="height"]').on('change', function () {
            var height = $(this).val();
            height && $('.netimg_prview').find('img').css('height', height);
        })

        //网络图片宽度
        $('input[name="width"]').on('change', function () {
            var width = $(this).val();
            width && $('.netimg_prview').find('img').css('width', width);
        })

        $("body").on("click", ".filelist li", function() {
            var that      = $(this);
            var id        = that.find('img').attr('src');
            var ischecked = that.find('.inp input').is(":checked");
            if(ischecked){
                that.find('.inp input').prop({checked:false});
            }else{
                that.find('.inp input').prop({checked:true});
            }

            var value   = (function () {
                var img = that.find('.inp input').val();
                if(img == undefined)
                {
                    return that.find('img').attr('src');
                }else{
                    return img;
                }
            })();

            {notempty name="get.more"}
            var vs      = allimg.val().split(',');
            //生成DOM功能
            var dom     = (function(){
                var str = '';
                if(objExp.test(value)) {
                    str = "<li id='img-" + id + "'>"
                        + "<img src='" + value + "' width='179' height='113' _src='" + value + "' style='margin-left: -33px;' />"
                        + "<span class='icon'></span>"
                        + "<span class='cancel'>{:lang("Delete")}</span>"
                    + "</li>";
                }else{
                    str = "<li id='img-" + id + "'>"
                        + "<img src='" + path + "/" + value + "' width='179' height='113' style='margin-left: -33px;' _src='" + path + "/" + value + "' />"
                        + "<span class='icon'></span>"
                        + "<span class='cancel'>{:lang("Delete")}</span> "
                    + "</li>";
                }
                return str;
            })();
            that.toggleClass('selected');

            var i=$.inArray(value,vs);

            {empty name="get.to_des"}
            if(!ischecked){
                if(i==-1)vs.push(value);
                pbd.find("#image-list li:last").before(dom);
            }else if(i!=-1){
                vs.splice(i,1);
                pbd.find("#img-" + id).remove();
            }

            vs[0]||vs.shift();

            // 返回描述框不用修改值

            pbd.find('#' + inputer).val(vs);
            {/empty}

            {else /}
            that.addClass('selected').siblings().removeClass('selected');
            var checkimg = $('.inp input:radio:checked').val();
            var img = (function () {
                if(checkimg != undefined)
                {
                    return objExp.test(checkimg) ? path + '/' + checkimg : checkimg;
                }else{

                    var selectedimg = that.find('img').attr('src');
                    return objExp.test(selectedimg) ? selectedimg : path + '/' + selectedimg;
                }
            })();

            {notempty name="get.wname"}
            if(pbd.find('#' + thumb).is('img'))
            {
                pbd.find('#' + thumb).attr('src', objExp.test(img) ? img : path + '/' + img );
            }
            {else /}
            if(parent.$('#' + thumb).is('img'))
            {
                var path = parent.$('#' + thumb).attr('data-upload');

                parent.$('#' + thumb).attr('src', objExp.test(img) ? img : path + '/' + img );
            }
            {/notempty}
            allimg.val(img);
            {/notempty}
        })

        //图片搜索
        $('input[name="search"]').on('click', function () {
            var searchkey = $('#searchkey').val();
            if (searchkey == '') {
                layer.msg('{:lang("Fix images key")}', {icon: 3});
                return false;
            }
        })

        //选定图片
        $('[name="Netimages"], [name="Onlinemag"], [name="Imagesearch"]').on('click', function () {
            var that = $(this);
            var id   = that.attr('name');
            {notempty name="get.more"}
            var select_img = $('#' + id).find('.filelist li.selected img').attr('src');
            {else /}
            var select_img = $('#' + id).find('.filelist li.selected img').attr('src');
            var img        = (function () {
                if(objExp.test(select_img) == true)
                {
                    return select_img;
                }else{
                    return path + '/' + select_img;
                }
            });

            {notempty name="get.wname"}
            if(pbd.find('#' + thumb).is('img'))
            {
                pbd.find('#' + thumb).attr('src', img);
            }
            {else /}
            allimg.val(img);
            if(parent.$('#' + thumb).is('img'))
            {
                var path = parent.$('.upload').attr('data-upload');
                parent.$('#' + thumb).attr('src', img);
            }
            {/notempty}
            {/notempty}

            if(allimg.val() == '')
            {
                layer.msg('{:lang("Noselect images")}', {icon: 2});
                return false;
            }
            parent.layer.close(topindex);
        })

        //上传功能部分开始
        var $wrap = $('#uploader'),
            // 图片容器
            $queue = $wrap.find('.filelist'),
            //$queue = $('<ul class="filelist"></ul>').appendTo($wrap.find( '.queueList' ) ),

            // 状态栏，包括进度和控制按钮
            $statusBar = $wrap.find('.statusBar'),

            // 文件总体选择信息。
            $info = $statusBar.find('.info'),

            // 上传按钮
            $upload = $wrap.find('.uploadBtn'),

            // 没选择文件之前的内容。
            $placeHolder = $wrap.find('.placeholder'),

            $progress = $statusBar.find('.progress').hide(),

            // 添加的文件数量
            fileCount = 0,

            // 添加的文件总大小
            fileSize = 0,

            // 优化retina, 在retina下这个值是2
            ratio = window.devicePixelRatio || 1,

            // 缩略图大小
            thumbnailWidth = 115 * ratio,
            thumbnailHeight = 115 * ratio,

            // 可能有pedding, ready, uploading, confirm, done.
            state = 'pedding',

            // 所有文件的进度信息，key为file id
            percentages = {},
            // 判断浏览器是否支持图片的base64
            isSupportBase64 = (function () {
                var data = new Image();
                var support = true;
                data.onload = data.onerror = function () {
                    if (this.width != 1 || this.height != 1) {
                        support = false;
                    }
                }
                data.src = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";
                return support;
            })(),

            // 检测是否已经安装flash，检测flash的版本
            flashVersion = (function () {
                var version;

                try {
                    version = navigator.plugins['Shockwave Flash'];
                    version = version.description;
                } catch (ex) {
                    try {
                        version = new ActiveXObject('ShockwaveFlash.ShockwaveFlash')
                            .GetVariable('$version');
                    } catch (ex2) {
                        version = '0.0';
                    }
                }
                version = version.match(/\d+/g);
                return parseFloat(version[0] + '.' + version[1], 10);
            })(),

            supportTransition = (function () {
                var s = document.createElement('p').style,
                    r = 'transition' in s ||
                        'WebkitTransition' in s ||
                        'MozTransition' in s ||
                        'msTransition' in s ||
                        'OTransition' in s;
                s = null;
                return r;
            })(),

            // WebUploader实例
            uploader;

        if (!WebUploader.Uploader.support('flash') && WebUploader.browser.ie) {

            // flash 安装了但是版本过低。
            if (flashVersion) {
                (function (container) {
                    window['expressinstallcallback'] = function (state) {
                        switch (state) {
                            case 'Download.Cancelled':
                                layer.msg('{:lang("You are cancel update")}', {icon: 5});
                                break;

                            case 'Download.Failed':
                                layer.msg('{:lang("Install fail")}', {icon: 2});
                                break;

                            default:
                                layer.msg('{:lang("Install succ and reflash")}', {icon: 1});
                                break;
                        }
                        delete window['expressinstallcallback'];
                    };

                    var swf = '__PUBLIC__/admin/images/expressInstall.swf';
                    // insert flash object
                    var html = '<object type="application/' +
                        'x-shockwave-flash" data="' + swf + '" ';

                    if (WebUploader.browser.ie) {
                        html += 'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ';
                    }

                    html += 'width="100%" height="100%" style="outline:0">' +
                        '<param name="movie" value="' + swf + '" />' +
                        '<param name="wmode" value="transparent" />' +
                        '<param name="allowscriptaccess" value="always" />' +
                        '</object>';
                    container.html(html);

                })($wrap);

                // 压根就没有安转。
            } else {
                $wrap.html('<a href="http://www.adobe.com/go/getflashplayer" target="_blank" border="0"><img alt="get flash player" src="http://www.adobe.com/macromedia/style_guide/images/160x41_Get_Flash_Player.jpg" /></a>');
            }

            return;
        } else if (!WebUploader.Uploader.support()) {
            layer.msg('{:lang("Not support your browser")}', {icon: 2});
            return;
        }

        // 实例化
        uploader = WebUploader.create({
            pick: {
                id: '#filePicker',
                label: '{:lang("Click Select pictures")}'
            },
            accept: {
                title: 'Images',
                extensions: '{:get_config("admin","index")["atttypes"]}',
                mimeTypes: '{$mimeTypes}'
            },
            /*formData: {
             uid: 123
             },*/
            dnd: '#dndArea',
            paste: '#uploader',
            swf: '__PUBLIC__/admin/images/Uploader.swf',
            chunked: false,
            chunkSize: 512 * 1024,
        {notempty name="get.isthumb"}
        server: '{:url("img", ['isthumb' => 1])}',
        {else /}
        server: '{:url("img")}',
        {/notempty}
        compress: null,     //不启用压缩
            resize: false,      //尺寸不改变
            // runtimeOrder: 'flash',
            
            /*accept: {
             title: 'Images',
             extensions: 'gif,jpg,jpeg,bmp,png',
             mimeTypes: 'image/!*'
             },*/

            // 禁掉全局的拖拽功能。这样不会出现图片拖进页面的时候，把图片打开。
            disableGlobalDnd: true,
            fileNumLimit: 300,
            fileSizeLimit: {:get_config('admin','index')['attsize']} * 1024 * 1024 * 200,    // 200 M
            fileSingleSizeLimit: {:get_config('admin','index')['attsize']} * 1024 * 1024    // 50 M
    });

        // 拖拽时不接受 js, txt 文件。
        uploader.on('dndAccept', function (items) {
            var denied = false,
                len = items.length,
                i = 0,
                // 修改js类型
                unAllowed = 'text/plain;application/javascript ';

            for (; i < len; i++) {
                // 如果在列表里面
                if (~unAllowed.indexOf(items[i].type)) {
                    denied = true;
                    break;
                }
            }

            return !denied;
        });

        uploader.on('dialogOpen', function () {
            console.log('here');
        });

        // uploader.on('filesQueued', function() {
        //     uploader.sort(function( a, b ) {
        //         if ( a.name < b.name )
        //           return -1;
        //         if ( a.name > b.name )
        //           return 1;
        //         return 0;
        //     });
        // });

        uploader.addButton({
            id: '#filePickerBlock'
        });

        // 添加“添加文件”的按钮，
        uploader.addButton({
            id: '#filePicker2',
            label: '{:lang("Continue to add")}'
        });

        uploader.on('ready', function () {
            window.uploader = uploader;
        });

        // 当有文件添加进来时执行，负责view的创建
        function addFile(file) {
            var type = {notempty name="get.more"}"checkbox"{else /}"radio"{/notempty};
            var $li = $('<li id="' + file.id + '">' +
                    '<p class="inp">' +
                    '<input type="'+type+'" name="imgs[]" class="ui-input" value="" /> ' +
                    '</p>' +
                    '<p class="title">' + file.name + '</p>' +
                    '<p class="imgWrap"></p>' +
                    '<p class="progress"><span></span></p>' +
                    '</li>'),

                $btns = $('<div class="file-panel">' +
                    '<span class="cancel">{:lang("Delete")}</span>' +
                    '<span class="rotateRight">{:lang("Toright rotate")}</span>' +
                    '<span class="rotateLeft">{:lang("Toleft rotate")}</span></div>').appendTo($li),
                $prgress = $li.find('p.progress span'),
                $wrap = $li.find('p.imgWrap'),
                $info = $('<p class="error"></p>'),

                showError = function (code) {
                    switch (code) {
                        case 'exceed_size':
                            text = '{:lang("File too big")}';
                            break;

                        case 'interrupt':
                            text = '{:lang("Upload pause")}';
                            break;

                        default:
                            text = '{:lang("Failed. Please try again")}';
                            break;
                    }

                    $info.text(text).appendTo($li);
                };

            if (file.getStatus() === 'invalid') {
                showError(file.statusText);
            } else {
                // @todo lazyload
                $wrap.text('{:lang("Previewing")}');
                uploader.makeThumb(file, function (error, src) {
                    var img;

                    if (error) {
                        $wrap.text('{:lang("Cant not preview")}');
                        return;
                    }

                    if (isSupportBase64) {
                        img = $('<img src="' + src + '">');
                        $wrap.empty().append(img);
                    } else {
                        /*$.ajax('../../server/preview.php', {
                         method: 'POST',
                         data: src,
                         dataType: 'json'
                         }).done(function (response) {
                         if (response.result) {
                         img = $('<img src="' + response.result + '">');
                         $wrap.empty().append(img);
                         } else {
                         $wrap.text("{:lang('Preview error')}");
                         }
                         });*/
                    }
                }, thumbnailWidth, thumbnailHeight);

                percentages[file.id] = [file.size, 0];
                file.rotation = 0;
            }

            file.on('statuschange', function (cur, prev) {
                if (prev === 'progress') {
                    $prgress.hide().width(0);
                } else if (prev === 'queued') {
                    $li.off('mouseenter mouseleave');
                    $btns.remove();
                }

                // 成功
                if (cur === 'error' || cur === 'invalid') {
                    console.log(file.statusText);
                    showError(file.statusText);
                    percentages[file.id][1] = 1;
                } else if (cur === 'interrupt') {
                    showError('interrupt');
                } else if (cur === 'queued') {
                    $info.remove();
                    $prgress.css('display', 'block');
                    percentages[file.id][1] = 0;
                } else if (cur === 'progress') {
                    $info.remove();
                    $prgress.css('display', 'block');
                } else if (cur === 'complete') {
                    $prgress.hide().width(0);
                    $li.append('<span class="success"></span>');
                }

                $li.removeClass('state-' + prev).addClass('state-' + cur);
            });

            $li.on('mouseenter', function () {
                $btns.stop().animate({height: 30});
            });

            $li.on('mouseleave', function () {
                $btns.stop().animate({height: 0});
            });

            $btns.on('click', 'span', function () {
                var index = $(this).index(),
                    deg;

                switch (index) {
                    case 0:
                        uploader.removeFile(file);
                        return;

                    case 1:
                        file.rotation += 90;
                        break;

                    case 2:
                        file.rotation -= 90;
                        break;
                }

                if (supportTransition) {
                    deg = 'rotate(' + file.rotation + 'deg)';
                    $wrap.css({
                        '-webkit-transform': deg,
                        '-mos-transform': deg,
                        '-o-transform': deg,
                        'transform': deg
                    });
                } else {
                    $wrap.css('filter', 'progid:DXImageTransform.Microsoft.BasicImage(rotation=' + (~~((file.rotation / 90) % 4 + 4) % 4) + ')');
                    // use jquery animate to rotation
                    // $({
                    //     rotation: rotation
                    // }).animate({
                    //     rotation: file.rotation
                    // }, {
                    //     easing: 'linear',
                    //     step: function( now ) {
                    //         now = now * Math.PI / 180;

                    //         var cos = Math.cos( now ),
                    //             sin = Math.sin( now );

                    //         $wrap.css( 'filter', "progid:DXImageTransform.Microsoft.Matrix(M11=" + cos + ",M12=" + (-sin) + ",M21=" + sin + ",M22=" + cos + ",SizingMethod='auto expand')");
                    //     }
                    // });
                }

            });

            $('#filePickerBlock').before($li);
            //$li.appendTo( $queue );
        }

        // 负责view的销毁
        function removeFile(file) {
            var $li = $('#' + file.id);

            delete percentages[file.id];
            updateTotalProgress();
            $li.off().find('.file-panel').off().end().remove();
        }

        function updateTotalProgress() {
            var loaded = 0,
                total = 0,
                spans = $progress.children(),
                percent;

            $.each(percentages, function (k, v) {
                total += v[0];
                loaded += v[0] * v[1];
            });

            percent = total ? loaded / total : 0;

            spans.eq(0).text(Math.round(percent * 100) + '%');
            spans.eq(1).css('width', Math.round(percent * 100) + '%');
            updateStatus();
        }

        function updateStatus() {
            var text = '', stats;

            if (state === 'ready') {
                text = '{:lang("Selected")}' + fileCount + '{:lang("Pic images total")}' +
                    WebUploader.formatSize(fileSize) + '。';
            } else if (state === 'confirm') {
                stats = uploader.getStats();
                if (stats.uploadFailNum) {
                    text = '{:lang("Success upload")}' + stats.successNum + '，' +
                        stats.uploadFailNum + ' {:lang("More upload failed")}，<a class="retry" href="#"> {:lang("Retry")}</a>{:lang("Fail or")}<a class="ignore" href="#"> {:lang("Ignore")}</a>'
                }

            } else {
                stats = uploader.getStats();
                text = '{:lang("Total")}' + fileCount + '{:lang("Pic")}（' +
                    WebUploader.formatSize(fileSize) +
                    '），{:lang("Uploaded")}' + stats.successNum + '{:lang("Pic")}';

                if (stats.uploadFailNum) {
                    text += '，{:lang("Fail")}' + stats.uploadFailNum + '{:lang("Pic")}';
                }
            }

            $info.html(text);
        }

        function setState(val, files) {
            var stats;

            if (val === state) {
                return;
            }

            $upload.removeClass('state-' + state);
            $upload.addClass('state-' + val);
            state = val;

            switch (state) {
                case 'pedding':
                    $placeHolder.removeClass('element-invisible');
                    //$queue.hide();
                    //$statusBar.addClass( 'element-invisible' );
                    $upload.addClass('element-invisible');
                    $('#filePicker2, #selected').addClass('element-invisible');
                    uploader.refresh();
                    break;
                case 'ready':
                    $placeHolder.addClass('element-invisible');
                    $upload.removeClass('element-invisible');
                    $('#filePicker2, #selected').removeClass('element-invisible');
                    $queue.removeClass('element-invisible');
                    //$statusBar.removeClass('element-invisible');
                    uploader.refresh();
                    break;
                case 'uploading':
                    $('#filePicker2').addClass('element-invisible');
                    $progress.show();
                    $upload.text('{:lang("Pause upload")}');
                    break;
                case 'paused':
                    $progress.show();
                    $upload.text('{:lang("Continue uploading")}');
                    break;
                case 'confirm':
                    $progress.hide();
                    $('#filePicker2').removeClass('element-invisible');
                    $upload.text('{:lang("Start uploading")}');
                    stats = uploader.getStats();
                    if (stats.successNum && !stats.uploadFailNum) {
                        setState('finish', files);
                        return;
                    }
                    break;
                case 'finish':
                    stats = uploader.getStats();
                    if (stats.successNum) {
                        layer.msg('{:lang("Upload success")}', {icon: 1});
                    } else {
                        // 没有成功的图片，重设
                        state = 'done';
                        location.reload();
                    }
                    $queue. find('.inp').show();
                    break;
            }

            updateStatus();
        }

        uploader.onUploadProgress = function (file, percentage) {
            var $li = $('#' + file.id),
                $percent = $li.find('.progress span');

            $percent.css('width', percentage * 100 + '%');
            percentages[file.id][1] = percentage;
            updateTotalProgress();
        };

        uploader.onFileQueued = function (file) {
            fileCount++;
            fileSize += file.size;

            if (fileCount === 1) {
                $placeHolder.addClass('element-invisible');
                $statusBar.show();
            }

            addFile(file);
            setState('ready');
            updateTotalProgress();
        };

        uploader.on( 'uploadSuccess', function( file, response ) {
            $queue. find('#' + file.id+' .inp input').val(response.data);
        });

        //当文件被移除队列后触发。
        uploader.onFileDequeued = function (file) {
            fileCount--;
            fileSize -= file.size;

            if (!fileCount) {
                setState('pedding', files);
            }

            removeFile(file);
            updateTotalProgress();

        };

        uploader.on('all', function (type) {
            switch (type) {
                case 'uploadFinished':  //当所有文件上传结束时触发
                    setState('confirm');
                    break;

                case 'startUpload': //当开始上传流程时触发
                    setState('uploading');
                    break;

                case 'stopUpload':
                    setState('paused');
                    break;
            }
        });

        uploader.onError = function (code) {
            layer.msg('Eroor: ' + code, {icon: 2});
        };

        $upload.on('click', function () {
            if ($(this).hasClass('disabled')) {
                return false;
            }

            if (state === 'ready') {
                uploader.upload();
            } else if (state === 'paused') {
                uploader.upload();
            } else if (state === 'uploading') {
                uploader.stop();
            }
        });

        $info.on('click', '.retry', function () {
            uploader.retry();
        });

        $info.on('click', '.ignore', function () {
            layer.msg('todo', {icon: 2});
        });

        $upload.addClass('state-' + state);
        updateTotalProgress();
    })
</script>

